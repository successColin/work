"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getENV=exports.getUA=void 0;var sdk_1=require("./sdk"),sdk_2=require("./sdk");Object.defineProperty(exports,"ENV_ENUM",{enumerable:!0,get:function(){return sdk_2.ENV_ENUM}}),Object.defineProperty(exports,"APP_TYPE",{enumerable:!0,get:function(){return sdk_2.APP_TYPE}}),Object.defineProperty(exports,"ENV_ENUM_SUB",{enumerable:!0,get:function(){return sdk_2.ENV_ENUM_SUB}});var dingtalk_javascript_env_1=require("./packages/dingtalk-javascript-env"),getTopBridge=function(){try{if("undefined"!=typeof window&&void 0!==window.top){return window.top.__dingtalk_jsapi_top_platfrom_config__}}catch(e){return}},EDdWeexEnv;!function(e){e.singlePage="singlePage",e.miniApp="miniApp",e.miniWidget="miniWidget"}(EDdWeexEnv||(EDdWeexEnv={})),exports.getUA=function(){var e="";try{"undefined"!=typeof navigator&&(e=navigator&&(navigator.userAgent||navigator.swuserAgent)||"")}catch(t){e=""}return e},exports.getENV=function(){var e,t,n=exports.getUA(),i=/iPhone|iPad|iPod|iOS/i.test(n),d=/Android/i.test(n),a=/DingTalk/i.test(n),o=/dd-web/i.test(n),r="object"==typeof nuva,_="object"==typeof dd&&"function"==typeof dd.dtBridge,s=/TaurusApp/.test(n),E=s&&!a,p=s&&a,g=E&&"undefined"!=typeof my&&null!==my&&void 0!==my.alert,l=s&&/dingtalk-win/.test(n),u=!l&&E&&i,v=!l&&E&&d,f=!l&&p&&i,c=!l&&p&&d,k=_&&i||r&&i,P=a||dingtalk_javascript_env_1.default.isDingTalk,N=i&&P||dingtalk_javascript_env_1.default.isWeexiOS||k,A=d&&P||dingtalk_javascript_env_1.default.isWeexAndroid,w=_,U=o,m=sdk_1.APP_TYPE.WEB;if(g)m=sdk_1.APP_TYPE.MINI_APP;else if(U)m=sdk_1.APP_TYPE.WEBVIEW_IN_MINIAPP;else if(w)m=sdk_1.APP_TYPE.MINI_APP;else if(dingtalk_javascript_env_1.default.isWeexiOS||dingtalk_javascript_env_1.default.isWeexAndroid)try{var M=weex.config.ddWeexEnv;m=M===EDdWeexEnv.miniWidget?sdk_1.APP_TYPE.WEEX_WIDGET:sdk_1.APP_TYPE.WEEX}catch(e){m=sdk_1.APP_TYPE.WEEX}var V,y="*",x=n.match(/AliApp\(\w+\/([a-zA-Z0-9.-]+)\)/);null===x&&(x=n.match(/DingTalk\/([a-zA-Z0-9.-]+)/));var T;x&&x[1]&&(T=x[1]);var W="";"undefined"!=typeof name&&(W=name);var I=getTopBridge();try{I&&"undefined"!=typeof window&&void 0!==window.top&&window.top!==window&&(W=top.name)}catch(e){}if(W)try{var S=JSON.parse(W);S.hostVersion&&(T=S.hostVersion),y=S.language||navigator.language||"*",V=S.containerId}catch(e){}var j=!!V||"undefined"!=typeof window&&(null===(t=null===(e=null===window||void 0===window?void 0:window.dingtalk)||void 0===e?void 0:e.platform)||void 0===t?void 0:t.invokeAPI);j&&!T&&(x=n.match(/DingTalk\(([a-zA-Z0-9\.-]+)\)/))&&x[1]&&(T=x[1]);var b,h=sdk_1.ENV_ENUM_SUB.noSub;if(l?(b=sdk_1.ENV_ENUM.gdtPc,h=sdk_1.ENV_ENUM_SUB.win):b=u?sdk_1.ENV_ENUM.gdtIos:v?sdk_1.ENV_ENUM.gdtAndroid:f?sdk_1.ENV_ENUM.gdtStandardIos:c?sdk_1.ENV_ENUM.gdtStandardAndroid:N?sdk_1.ENV_ENUM.ios:A?sdk_1.ENV_ENUM.android:j?sdk_1.ENV_ENUM.pc:I&&I.platform?I.platform:sdk_1.ENV_ENUM.notInDingTalk,b===sdk_1.ENV_ENUM.pc){h=n.indexOf("Macintosh; Intel Mac OS")>-1?sdk_1.ENV_ENUM_SUB.mac:sdk_1.ENV_ENUM_SUB.win}return{platform:b,platformSub:h,version:T,appType:m,language:y}};