(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-frames-inspection-download-download~pages-frames-inspection-inspection-inspectionDevice~pages-~0f17aa9d"],{"1ce4e":function(t,n,o){"use strict";o("7a82");var e=o("4ea4").default;Object.defineProperty(n,"__esModule",{value:!0}),n.updateUploadstatus=n.updateSql=n.updateManhourSql=n.selectPointsResults=n.selectPointsByInspectionDoId=n.selectPointDoList=n.selectMoList=n.selectManhours=n.selectInspectionUpData=n.selectInspectionHistory=n.selectInspectionDo=n.selectFileList=n.selectAllFile=n.readyDB=n.insertIntoInspectionDo=n.insertInspectionpointDo=n.insertFile=n.forceInspection=n.dropInspectionTables=n.deleteSkipMo=n.deleteRoute=n.deletePointByInspec=n.deleteFile=n.currencyHaiLiScanning=void 0,o("d3b7"),o("159b"),o("d81d"),o("99af"),o("b64b"),o("3ca3"),o("ddb0");var i=e(o("d9fd")),c=function(t,n){i.default.executeSql("CREATE TABLE inspectiondo (\n\t\t  id INTEGER PRIMARY KEY AUTOINCREMENT,\n\t\t  keycode VARCHAR(50) NOT NULL,\n\t\t  name VARCHAR(50) DEFAULT NULL,\n\t\t  createdate text DEFAULT NULL,\n\t\t  createuserid int DEFAULT NULL,\n\t\t  modificationdate text DEFAULT NULL,\n\t\t  modificationuserid int DEFAULT NULL,\n\t\t  basestate int DEFAULT NULL,\n\t\t  basetype int DEFAULT NULL,\n\t\t  basepriority int DEFAULT NULL,\n\t\t  stateid int DEFAULT NULL,\n\t\t  typeid int DEFAULT NULL,\n\t\t  priorityid int DEFAULT NULL,\n\t\t  orgid int DEFAULT NULL,\n\t\t  memo VARCHAR(1000) DEFAULT NULL,\n\t\t  picpath VARCHAR(200) DEFAULT NULL,\n\t\t  barcode VARCHAR(200) DEFAULT NULL,\n\t\t  qrcode VARCHAR(200) DEFAULT NULL,\n\t\t  tombstone int DEFAULT '1',\n\t\t  extype int DEFAULT '1',\n\t\t  enabled int DEFAULT '1',\n\t\t  rootpath VARCHAR(200) DEFAULT NULL,\n\t\t  sno int DEFAULT NULL,\n\t\t  iconid int DEFAULT NULL,\n\t\t  companyid int DEFAULT NULL,\n\t\t  colorcode VARCHAR(50) DEFAULT NULL,\n\t\t  locked int DEFAULT NULL,\n\t\t  rootid int DEFAULT '0',\n\t\t  groupid int DEFAULT NULL,\n\t\t  initialdata tinyint(1) DEFAULT '0',\n\t\t  costcenterid int DEFAULT NULL,\n\t\t  insusergroupid int DEFAULT NULL,\n\t\t  inspectionplanid int DEFAULT NULL,\n\t\t  planstartdate text DEFAULT NULL,\n\t\t  planenddate text DEFAULT NULL,\n\t\t  pointordertype int DEFAULT NULL,\n\t\t  moordertype int DEFAULT NULL,\n\t\t  startdate text DEFAULT NULL,\n\t\t  enddate text DEFAULT NULL,\n\t\t  finisheduserid int DEFAULT NULL,\n\t\t  confirmuserid int DEFAULT NULL,\n\t\t  manhours decimal(12,4) DEFAULT NULL,\n\t\t  pointdocount int DEFAULT NULL,\n\t\t  operatingstatus tinyint(1) DEFAULT '0',\n\t\t  uploadstatus tinyint(1) DEFAULT '0'\n\t)",(function(){console.log("巡检路线表创建成功"),t&&t()}),(function(t){console.log("巡检路线表创建失败"),n&&n(t)}))},d=function(t,n){i.default.executeSql("CREATE TABLE inspectionpointdo (\n\t\tid INTEGER PRIMARY KEY AUTOINCREMENT,\n\t\tkeycode VARCHAR(50) NOT NULL,\n\t\tname VARCHAR(50) DEFAULT NULL,\n\t\tcreatedate text DEFAULT NULL,\n\t\tcreateuserid int DEFAULT NULL,\n\t\tmodificationdate text DEFAULT NULL,\n\t\tmodificationuserid int DEFAULT NULL,\n\t\tbasestate int DEFAULT NULL,\n\t\tbasetype int DEFAULT NULL,\n\t\tbasepriority int DEFAULT NULL,\n\t\tstateid int DEFAULT '0',\n\t\ttypeid int DEFAULT NULL,\n\t\tpriorityid int DEFAULT NULL,\n\t\torgid int DEFAULT NULL,\n\t\torgkey VARCHAR(50) DEFAULT NULL,\n\t\torgname VARCHAR(50) DEFAULT NULL,\n\t\tmemo VARCHAR(1000) DEFAULT NULL,\n\t\tpicpath VARCHAR(200) DEFAULT NULL,\n\t\tbarcode VARCHAR(200) DEFAULT NULL,\n\t\tqrcode VARCHAR(200) DEFAULT NULL,\n\t\ttombstone int DEFAULT '1',\n\t\textype int DEFAULT '1',\n\t\tenabled int DEFAULT '1',\n\t\trootpath VARCHAR(200) DEFAULT NULL,\n\t\tsno int DEFAULT NULL,\n\t\ticonid int DEFAULT NULL,\n\t\tcompanyid int DEFAULT NULL,\n\t\tcolorcode VARCHAR(50) DEFAULT NULL,\n\t\tlocked int DEFAULT NULL,\n\t\trootid int DEFAULT NULL,\n\t\tgroupid int DEFAULT NULL,\n\t\tinitialdata tinyint(1) DEFAULT '0',\n\t\tcostcenterid int DEFAULT NULL,\t\n\t\tinspectiondoid int NOT NULL,\n\t\tinspectionpointplanid int NOT NULL,\n\t\tmoid int DEFAULT NULL,\n\t\tmokey VARCHAR(50) NOT NULL,\n\t\tmoname VARCHAR(50) DEFAULT NULL,\n\t\tposid int DEFAULT NULL,\n\t\tposkey VARCHAR(50) DEFAULT NULL,\n\t\tposname VARCHAR(50) DEFAULT NULL,\n\t\tinsusergroupid int DEFAULT NULL,\n\t\tchecktype int(11) DEFAULT '1',\n\t\tcheckuserid int(11) DEFAULT NULL,\n\t\tinstrumentkey VARCHAR(50) DEFAULT NULL,\n\t\tinstrumentname VARCHAR(50) DEFAULT NULL,\n\t\texecutecycletype int DEFAULT NULL,\n\t\texecutecyclevalue int DEFAULT NULL,\n\t\tfixedexecutecycle int DEFAULT NULL,\n\t\tjobstandard VARCHAR(1000) DEFAULT NULL,\n\t\tjobmethod VARCHAR(200) DEFAULT NULL,\n\t\tlowerlimitvalue decimal(12,4) DEFAULT NULL,\n\t\tupperlimitvalue decimal(12,4) DEFAULT NULL,\n\t\toilqty decimal(12,4) DEFAULT NULL,\n\t\tplanstartdate text DEFAULT NULL,\n\t\tplanenddate text DEFAULT NULL,\n\t\tspkey VARCHAR(50) DEFAULT NULL,\n\t\tspname VARCHAR(50) DEFAULT NULL,\n\t\tspunitname VARCHAR(50) DEFAULT NULL,\n\t\tcounterheaderkey VARCHAR(50) DEFAULT NULL,\n\t\tintervalcount int DEFAULT NULL,\n\t\tintervalcountnext int DEFAULT NULL,\n\t\tintervaldiscount int DEFAULT NULL,\n\t\tmoorder int DEFAULT NULL,\n\t\tpointorder int DEFAULT NULL,\n\t\trfid VARCHAR(50) DEFAULT NULL,\n\t\toperatingstatus tinyint(1) DEFAULT '0',\n\t\tuploadstatus tinyint(1) DEFAULT '0',\n\t\tdescription VARCHAR(1000) DEFAULT NULL,\n\t\tcheckvalue decimal(12,4) DEFAULT NULL,\n\t\tcheckdate text DEFAULT NULL,\n\t\tunitid int DEFAULT NULL,\n\t\tunitname VARCHAR(50) DEFAULT NULL,\n\t\tunitcode VARCHAR(50) DEFAULT NULL,\n\t\tstoragelocation VARCHAR(50) DEFAULT NULL\n\t)",(function(){console.log("巡检点表创建成功"),t&&t()}),(function(t){console.log("巡检点表创建失败"),n&&n(t)}))},a=function(t,n){i.default.executeSql("CREATE TABLE inspectionfiles (  \n\t\t  id INTEGER PRIMARY KEY AUTOINCREMENT,  \n\t\t  inspectiondoid int DEFAULT NULL,  \n\t\t  inspectionpointdoid int DEFAULT NULL, \n\t\t  filetype int DEFAULT NULL, \n\t\t  filepath varchar(200) DEFAULT NULL,\n\t\t  type int DEFAULT NULL,\n\t\t  createdate text DEFAULT NULL,\n\t\t  createuserid int DEFAULT NULL,\n\t\t  modificationdate text DEFAULT NULL,\n\t\t  modificationuserid int DEFAULT NULL,\n\t\t  tombstone int DEFAULT NULL,\n\t\t  uploadstatus int default '0' \n\t\t );",(function(){console.log("文件表创建成功"),t&&t()}),(function(t){console.log("文件表创建失败"),n&&n(t)}))};n.readyDB=function(t,n){i.default.openDB([c,d,a],(function(n){t&&t(n)}),(function(t){n&&n(t)}))};n.insertIntoInspectionDo=function(t,n,o){if(console.log(t),0!==t.length){var e="",c=["id","keyCode","name","createDate","createUserId","modificationDate","modificationUserId","baseState","baseType","basePriority","stateId","typeId","priorityId","orgId","memo","picPath","barCode","qrCode","rootPath","sno","iconId","companyId","colorCode","locked","rootId","groupId","initialData","costCenterId","insUserGroupId","inspectionPlanId","planStartDate","planEndDate","pointOrderType","moOrderType","startDate","endDate","finishedUserId","confirmUserId"];t.forEach((function(t,n){var o=0===n?" select ":" union all select ",i=c.map((function(n,o){return t[n]||0===t[n]?"'".concat(t[n],"'"):"null"}));e+=o+i.join(",")}));var d="insert into inspectiondo(".concat(["id","keycode","name","createdate","createuserid","modificationdate","modificationuserid","basestate","basetype","basepriority","stateid","typeid","priorityid","orgid","memo","picpath","barcode","qrcode","rootpath","sno","iconid","companyid","colorcode","locked","rootid","groupid","initialdata","costcenterid","insusergroupid","inspectionplanid","planstartdate","planenddate","pointordertype","moordertype","startdate","enddate","finisheduserid","confirmuserid"].join(","),") ").concat(e,";");i.default.executeSql(d,(function(){n&&n()}),(function(t){o&&o(t)}))}};n.insertInspectionpointDo=function(t,n,o){if(0!==t.length){var e="",c=["id","keyCode","name","createDate","createUserId","modificationDate","modificationUserId","baseState","baseType","basePriority","typeId","priorityId","orgId","orgKey","orgName","memo","picPath","barCode","qrCode","rootPath","sno","iconId","companyId","colorCode","locked","rootId","groupId","initialData","costCenterId","inspectionDoId","inspectionPointPlanId","moKey","moName","posId","posKey","posName","insUserGroupId","checkType","checkUserId","instrumentKey","instrumentName","executeCycleType","executeCycleValue","fixedExecuteCycle","jobStandard","jobMethod","lowerLimitValue","upperLimitValue","oilQty","planStartDate","planEndDate","spKey","spName","spUnitName","counterHeaderKey","intervalCount","intervalCountNext","intervalDisCount","moOrder","pointOrder","moId","rfid","unitId","unitName","unitCode","storagelocation"];t.forEach((function(t,n){var o=0===n?" select ":" union all select ",i=c.map((function(n,o){return t[n]||0===t[n]?"'".concat(t[n],"'"):"null"}));t.unitId&&console.log("有测量单位======================================="),e+=o+i.join(",")}));var d="insert into inspectionpointdo(".concat(["id","keycode","name","createdate","createuserid","modificationdate","modificationuserid","basestate","basetype","basepriority","typeid","priorityid","orgid","orgkey","orgname","memo","picpath","barcode","qrcode","rootpath","sno","iconid","companyid","colorcode","locked","rootid","groupid","initialdata","costcenterid","inspectiondoid","inspectionpointplanid","mokey","moname","posid","poskey","posname","insusergroupid","checktype","checkuserid","instrumentkey","instrumentname","executecycletype","executecyclevalue","fixedexecutecycle","jobstandard","jobmethod","lowerlimitvalue","upperlimitvalue","oilqty","planstartdate","planenddate","spkey","spname","spunitname","counterheaderkey","intervalcount","intervalcountnext","intervaldiscount","moorder","pointorder","moid","rfid","unitid","unitname","unitcode","storagelocation"].join(","),") ").concat(e,";");i.default.executeSql(d,(function(){n&&n()}),(function(t){o&&o(t)}))}};n.insertFile=function(t,n,o){if(0!==t.length){var e="",c=["id","inspectiondoid","inspectionpointdoid","filetype","filepath","type","createdate","createuserid","modificationdate","modificationuserid","tombstone"];t.forEach((function(t,n){var o=0===n?" select ":" union all select ",i=c.map((function(n,o){return void 0===t[n]?"null":"'".concat(t[n],"'")}));e+=o+i.join(",")}));var d="insert into inspectionfiles(".concat(c.join(","),") ").concat(e,";");i.default.executeSql(d,(function(){n&&n()}),(function(t){o&&o(t)}))}};n.selectFileList=function(t,n,o){var e="SELECT * FROM\n\t\t\tinspectionfiles\n\t\tWHERE\n\t\t\tinspectionpointdoid = ".concat(t,";");i.default.selectSql(e,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.deleteFile=function(t,n,o){var e="DELETE FROM inspectionfiles WHERE id = ".concat(t,";");i.default.executeSql(e,(function(){n&&n()}),(function(t){o&&o(t)}))};n.selectInspectionDo=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,o=arguments.length>2?arguments[2]:void 0,e=t.keywords?" AND (inspectiondo.keycode like '%".concat(t.keywords,"%' OR inspectiondo.name like '%").concat(t.keywords,"%')"):"",c=t.keycode?" AND inspectiondo.keycode = '".concat(t.keycode,"'"):"",d=t.name?" AND inspectiondo.name = '".concat(t.name,"'"):"",a=t.startDate?" AND inspectionpointdo.planstartdate >= '".concat(t.startDate,"'"):"",s=t.endDate?" AND inspectionpointdo.planstartdate <= '".concat(t.endDate,"'"):"",p="SELECT inspectiondo.id,inspectiondo.keycode AS inspectionDoKeyCode, inspectiondo.name AS inspectionDoName,\n\t\t\tinspectiondo.createdate, COUNT(*) AS pointCount,MIN(inspectionpointdo.planstartdate) as minPlanStartDate,\n\t\t\tMAX(inspectionpointdo.planstartdate) as maxPlanStartDate,\n\t\t\tSUM(inspectionpointdo.operatingstatus) AS finishPointCount,\n\t\t\tinspectiondo.basetype AS baseType,\n\t\t\t(SELECT COUNT(*) \n\t\t\tFROM (SELECT mokey,inspectiondoid \n\t\t\t\t\tFROM inspectionpointdo \n\t\t\t\t\tWHERE inspectionpointdo.uploadstatus != 1\n\t\t\t\t\tGROUP BY inspectiondoid,mokey\n\t\t\t\t) motable\n\t\t\tWHERE motable.inspectiondoid = inspectiondo.id) AS moCount,\n\t\t\t(SELECT COUNT(1) \n\t\t\t\tFROM (SELECT COUNT(*) AS pointcount,SUM(operatingstatus) AS operatingcount,inspectiondoid\n\t\t\t\t\tFROM inspectionpointdo\n\t\t\t\t\tWHERE inspectionpointdo.uploadstatus != 1\n\t\t\t\t\tGROUP BY inspectiondoid,mokey\n\t\t\t\t\tHAVING pointcount = operatingcount) finishMoTable\n\t\t\tWHERE finishMoTable.inspectiondoid = inspectiondo.id) AS finishMoCount\n\t\tFROM\n\t\t\tinspectionpointdo\n\t\tLEFT JOIN inspectiondo ON inspectionpointdo.inspectiondoid = inspectiondo.id\n\t\tWHERE\n\t\t\tinspectionpointdo.uploadstatus != 1\n\t\t".concat(e).concat(c).concat(d).concat(a).concat(s,"\n\t\tGROUP BY\n\t\t\tinspectionpointdo.inspectiondoid\n\t\tORDER BY \n\t\t\tminPlanStartDate;");i.default.selectSql(p,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.selectMoList=function(t,n,o){var e="SELECT\n\t\t\tinspectionpointdo.storagelocation,\n\t\t\tinspectionpointdo.inspectiondoid,\n\t\t\tinspectionpointdo.moid,\n\t\t\tinspectionpointdo.mokey,\n\t\t\tinspectionpointdo.moname,\n\t\t\tinspectionpointdo.posid,\n\t\t\tinspectionpointdo.poskey,\n\t\t\tinspectionpointdo.posname,\n\t\t\tinspectionpointdo.orgid,\n\t\t\tinspectionpointdo.orgkey,\n\t\t\tinspectionpointdo.orgname,\n\t\t\tinspectionpointdo.qrcode,\n\t\t\t(sum(inspectionpointdo.stateid) > sum(inspectionpointdo.operatingstatus) ) AS isAbnormal,\n\t\t\t(SELECT COUNT(*)\n\t\t\tFROM (SELECT mokey,inspectiondoid \n\t\t\t\t\tFROM inspectionpointdo \n\t\t\t\t\tWHERE inspectionpointdo.uploadstatus != 1 AND inspectionpointdo.stateid = 2\n\t\t\t\t\tGROUP BY inspectiondoid,mokey\n\t\t\t\t) motable\n\t\t\tWHERE motable.inspectiondoid = ".concat(t," AND motable.mokey = inspectionpointdo.mokey) AS abnormalMoCount,\n\t\t\t(SELECT COUNT(*)\n\t\t\tFROM (SELECT mokey,inspectiondoid \n\t\t\t\t\tFROM inspectionpointdo \n\t\t\t\t\tWHERE inspectionpointdo.uploadstatus != 1 AND inspectionpointdo.stateid = 3\n\t\t\t\t\tGROUP BY inspectiondoid,mokey\n\t\t\t\t) motable\n\t\t\tWHERE motable.inspectiondoid = ").concat(t," AND motable.mokey = inspectionpointdo.mokey) AS shutdownMoCount,\n\t\t\tcount(*) AS moPointCount,\n\t\t\tsum(inspectionpointdo.operatingstatus) AS moOperatingCount,\n\t\t\tinspectionpointdo.rfid,\n\t\t\tinspectiondo.moordertype,\n\t\t\tmax(inspectionpointdo.planstartdate) AS moMaxPlanStartDate\n\t\tFROM\n\t\t\tinspectionpointdo\n\t\t\tLEFT JOIN inspectiondo ON inspectionpointdo.inspectiondoid = inspectiondo.id\n\t\tWHERE\n\t\t\tinspectiondoid = ").concat(t,"\n\t\tAND inspectionpointdo.uploadstatus != 1\n\t\tGROUP BY\n\t\t\tinspectionpointdo.inspectiondoid,\n\t\t\tinspectionpointdo.mokey");i.default.selectSql(e,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.selectManhours=function(t,n,o){var e="select manhours from inspectiondo where id=".concat(t);i.default.selectSql(e,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.selectPointDoList=function(t,n,o,e){var c="SELECT\n\t\t\tinspectionpointdo.id,\n\t\t\tinspectionpointdo.keycode AS pointKeyCode,\n\t\t\tinspectionpointdo.name AS pointName,\n\t\t\tinspectionpointdo.inspectiondoid,\n\t\t\tinspectionpointdo.planstartdate,\n\t\t\tinspectionpointdo.checktype,\n\t\t\tinspectionpointdo.operatingstatus,\n\t\t\tinspectionpointdo.instrumentkey,\n\t\t\tinspectionpointdo.instrumentname,\n\t\t\tinspectionpointdo.upperlimitvalue,\n\t\t\tinspectionpointdo.lowerlimitvalue,\n\t\t\tinspectionpointdo.executecycletype,\n\t\t\tinspectionpointdo.executecyclevalue,\n\t\t\tinspectionpointdo.fixedexecutecycle,\n\t\t\tinspectionpointdo.jobstandard,\n\t\t\tinspectionpointdo.jobmethod,\n\t\t\tinspectionpointdo.oilqty,\n\t\t\tinspectionpointdo.pointorder,\n\t\t\tinspectionpointdo.typeid,\n\t\t\tinspectionpointdo.stateid,\n\t\t\tinspectionpointdo.memo,\n\t\t\tinspectionpointdo.description,\n\t\t\tinspectionpointdo.checkvalue,\n\t\t\tinspectionpointdo.checkdate,\n\t\t\tinspectionpointdo.unitid,\n\t\t\tinspectionpointdo.unitname,\n\t\t\tinspectionpointdo.unitcode\n\t\tFROM\n\t\t\tinspectionpointdo\n\t\tLEFT JOIN inspectiondo ON inspectiondo.id = inspectionpointdo.inspectiondoid\n\t\tWHERE\n\t\t\tinspectionpointdo.inspectiondoid = ".concat(t,"\n\t\tAND inspectionpointdo.mokey = '").concat(n,"'\n\t\tAND inspectionpointdo.uploadstatus != 1\n\t\tORDER BY\n\t\t\tinspectionpointdo.sno IS NULL,\n\t\t\tinspectionpointdo.sno ASC,\n\t\t\tinspectionpointdo.id ASC;");i.default.selectSql(c,(function(t){o&&o(t)}),(function(t){e&&e(t)}))};n.updateSql=function(t,n,o,e,c){if("[object Object]"===Object.prototype.toString.call(n)||"[object Object]"===Object.prototype.toString.call(o)){var d=Object.keys(n).map((function(t){return"".concat(t,"='").concat(n[t],"'")})),a=Object.keys(o).map((function(t){return"".concat(t,"='").concat(o[t],"'")})),s=d.join(","),p=a.join(" AND "),r="UPDATE ".concat(t," SET ").concat(s," WHERE ").concat(p,";");i.default.executeSql(r,(function(){e&&e()}),(function(t){c&&c(t),uni.showModal({title:"提示",content:"数据更新失败"})}))}};n.selectPointsByInspectionDoId=function(t,n,o){var e="select \n\t\t   id AS inspectionPointDoId, keycode AS keyCode, name, basestate AS baseState, \n\t\t   basetype AS baseType, basepriority AS basePriority, stateid AS stateId, \n\t\t   typeid AS typeId, priorityid AS priorityId, orgid AS orgId, memo, description, \n\t\t   picpath AS picPath, barcode AS barCode, qrcode AS qrCode, rootpath AS rootPath, sno, iconid AS iconId, companyid AS companyId, \n\t\t   colorcode AS colorCode, locked, rootid AS rootId, groupid AS groupId, \n\t\t   initialdata AS initialData, costcenterid AS costCenterId, moid AS moId, mokey AS moKey, moname AS moName, \n\t\t   poskey AS posKey, posname AS posName, insusergroupid AS insUserGroupId, \n\t\t   checktype AS checkType, checkuserid AS checkUserId, checkvalue AS checkValue, \n\t\t   instrumentkey AS instrumentKey, instrumentname AS instrumentName, \n\t\t   executecycletype AS executeCycleType, executecyclevalue AS executeCycleValue, fixedexecutecycle AS fixedExecuteCycle,\n\t\t   jobstandard AS jobStandard, jobmethod AS jobMethod, lowerlimitvalue AS lowerLimitValue, upperlimitvalue AS upperLimitValue, \n\t\t   oilqty AS oilQty, planstartdate AS planStartDate, planenddate AS planEndDate,\n\t\t   spkey AS spKey, spname AS spName, spunitname AS spUnitName, counterheaderkey AS counterHeaderKey, \n\t\t   intervalcount AS intervalCount, intervalcountnext AS intervalCountNext, intervaldiscount AS intervalDisCount,\n\t\t   moorder AS moOrder, pointorder AS pointOrder, checkdate AS checkDate, operatingstatus , uploadstatus,\n\t\t   inspectionpointplanid as inspectionPointPlanId, inspectiondoid as inspectionDoId\n\t\tfrom \n\t\t\tinspectionpointdo \n\t\twhere \n\t\t\toperatingstatus = 1 AND inspectionpointdo.uploadstatus = 0 and inspectiondoid = ".concat(t,";");i.default.selectSql(e,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.selectPointsResults=function(t,n,o){var e="select \n\t\t   id, keycode, name AS pointName, basestate, \n\t\t   basetype, basepriority, stateid, \n\t\t   typeid, priorityid, orgid, memo, description, \n\t\t   picpath, barcode, qrcode, rootpath, sno, iconid, companyid, \n\t\t   colorcode, locked, rootid, groupid, \n\t\t   initialdata, costcenterid, mokey, moname, \n\t\t   poskey, posname, insusergroupid, \n\t\t   checktype, checkuserid, checkvalue, \n\t\t   instrumentkey, instrumentname, \n\t\t   executecycletype, executecyclevalue, fixedexecutecycle,\n\t\t   jobstandard, jobmethod, lowerlimitvalue, upperlimitvalue, \n\t\t   oilqty, planstartdate, planenddate,\n\t\t   spkey, spname, spunitname, counterheaderkey, \n\t\t   intervalcount, intervalcountnext, intervaldiscount,\n\t\t   moorder, pointorder, checkdate, operatingstatus , uploadstatus, unitid, unitname, unitcode\n\t\tfrom \n\t\t\tinspectionpointdo \n\t\twhere \n\t\t\toperatingstatus = 1 AND inspectionpointdo.uploadstatus = 0 and inspectiondoid = ".concat(t,";");i.default.selectSql(e,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.selectInspectionHistory=function(t,n){i.default.selectSql("SELECT\n\t  inspectiondo.id,\n\t  inspectiondo.keycode AS inspectionDoKeyCode,\n\t  inspectiondo.NAME AS inspectionDoName,\n\t  inspectiondo.manhours,\n\t  COUNT(*) AS allCount,\n\t  SUM(\n\t   CASE\n\t   WHEN inspectionpointdo.stateid = 1 THEN\n\t\t1\n\t   ELSE\n\t\t0\n\t   END\n\t  ) AS normalCount,\n\t  SUM(\n\t   CASE\n\t   WHEN inspectionpointdo.stateid = 2 THEN\n\t\t1\n\t   ELSE\n\t\t0\n\t   END\n\t  ) AS abNormalCount,\n\t\tSUM(\n\t\t CASE\n\t\t WHEN inspectionpointdo.stateid = 3 THEN\n\t\t1\n\t\t ELSE\n\t\t0\n\t\t END\n\t\t) AS shutdownCount,\n\t  (\n\t   SELECT\n\t\tCOUNT(*)\n\t   FROM\n\t\t(\n\t\t SELECT\n\t\t  mokey,\n\t\t  inspectiondoid\n\t\t FROM\n\t\t  inspectionpointdo\n\t\t WHERE operatingstatus = 1 AND inspectionpointdo.uploadstatus = 0\n\t\t GROUP BY\n\t\t  inspectiondoid,\n\t\t  mokey\n\t\t) motable\n\t   WHERE\n\t\tmotable.inspectiondoid = inspectiondo.id\n\t  ) AS moCount,\n\t  inspectiondo.createdate\n\t FROM\n\t  inspectionpointdo\n\t LEFT JOIN inspectiondo ON inspectionpointdo.inspectiondoid = inspectiondo.id\n\t WHERE inspectionpointdo.operatingstatus = 1 AND inspectionpointdo.uploadstatus = 0 AND inspectiondo.manHours is not null\n\t GROUP BY\n  inspectionpointdo.inspectiondoid;",(function(n){t&&t(n)}),(function(t){n&&n(t)}))};n.dropInspectionTables=function(t,n){i.default.closeDB((function(){plus.sqlite.openDatabase({name:"EAMDB",path:"_doc/EAMDB.db",success:function(o){var e=["inspectiondo","inspectionpointdo","inspectionfiles"].map((function(t,n){return new Promise((function(n,o){i.default.drop(t,n,o)}))}));Promise.all(e).then((function(n){i.default.closeDB((function(){t&&t(n)}))})).catch((function(t){n&&n(t),uni.showModal({title:"提示",content:"数据表删除失败"})}))},fail:function(){console.log("openDatabase失败")}})}))};n.selectInspectionUpData=function(t,n){i.default.selectSql("SELECT\n   inspectiondo.id AS inspectionDoId,\n   inspectiondo.keycode AS keyCode,\n   inspectiondo.name,\n   inspectiondo.basestate AS baseState,\n   inspectiondo.basetype AS baseType,\n   inspectiondo.basepriority AS basePriority,\n   inspectiondo.stateid AS stateId,\n   inspectiondo.typeid AS typeId,\n   inspectiondo.priorityid AS priorityId,\n   inspectiondo.orgid AS orgId,\n   inspectiondo.memo,\n   inspectiondo.picpath AS picPath,\n   inspectiondo.barcode AS barCode,\n   inspectiondo.qrcode AS qrCode,\n   inspectiondo.sno,\n   inspectiondo.iconid AS iconId,\n   inspectiondo.companyid AS companyId,\n   inspectiondo.colorcode AS colorCode,\n   inspectiondo.locked,\n   inspectiondo.rootid AS rootId,\n   inspectiondo.groupid AS groupId,\n   inspectiondo.initialdata AS initialData,\n   inspectiondo.costcenterid AS costCenterId,\n   inspectiondo.insusergroupid AS insUserGroupId,\n   inspectiondo.inspectionplanid as inspectionPlanId,\n   inspectiondo.planstartdate AS planStartDate,\n   inspectiondo.planenddate AS planEndDate,\n   inspectiondo.pointordertype AS pointOrderType,\n   inspectiondo.moordertype AS moOrderType,\n   inspectiondo.startdate AS startDate,\n   inspectiondo.enddate AS endDate,\n   inspectiondo.finisheduserid AS finishedUserId,\n   inspectiondo.confirmuserid AS confirmUserId,\n   inspectiondo.manhours AS manHours,\n   inspectiondo.pointdocount AS pointDoCount\n FROM\n  inspectionpointdo\n LEFT JOIN inspectiondo ON inspectionpointdo.inspectiondoid = inspectiondo.id\n WHERE inspectionpointdo.operatingstatus = 1 AND inspectionpointdo.uploadstatus = 0 AND inspectiondo.manHours is not null\n GROUP BY\n  inspectionpointdo.inspectiondoid;",(function(n){t&&t(n)}),(function(t){n&&n(t)}))};n.updateUploadstatus=function(t,n,o,e){var c=n.join(","),d="UPDATE ".concat(t," SET uploadstatus = 1 WHERE id in (").concat(c,");");i.default.executeSql(d,(function(){o&&o()}),(function(t){e&&e(t)}))};n.updateManhourSql=function(t,n,o,e){var c=n.join(","),d="UPDATE ".concat(t," SET manhours = null WHERE id in (").concat(c,");");i.default.executeSql(d,(function(){o&&o()}),(function(t){e&&e(t),uni.showModal({title:"提示",content:"数据更新失败"})}))};n.selectAllFile=function(t,n){i.default.selectSql("SELECT\n\t\tid,\n\t\tinspectionpointdoid,\n\t\tfilepath,\n\t\tcreateuserid\n\tFROM\n\t\tinspectionfiles\n\tWHERE\n\t\tuploadstatus = 0;",(function(n){t&&t(n)}),(function(t){n&&n(t)}))};n.deleteRoute=function(t,n,o){var e="delete from inspectiondo where id in (".concat(t,");");i.default.selectSql(e,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.deleteSkipMo=function(t,n,o,e){var c="DELETE FROM inspectionpointdo WHERE inspectiondoid = ".concat(t," AND inspectionpointdo.mokey IN (").concat(n,")");i.default.selectSql(c,(function(t){o&&o(t)}),(function(t){e&&e(t)}))};n.deletePointByInspec=function(t,n,o){var e="delete from inspectionpointdo where inspectiondoid in (".concat(t,");");i.default.selectSql(e,(function(t){n&&n(t)}),(function(t){o&&o(t)}))};n.currencyHaiLiScanning=function(t,n,o,e){console.log(n),console.log(t);var c="select mokey from inspectionpointdo  where ';"+t+";' like '%;'||mokey||';%' and inspectiondoid = "+n+" group by mokey";i.default.selectSql(c,(function(t){o&&o(t)}),(function(t){e&&e(t)}))};n.forceInspection=function(t,n){var o="SELECT a.moname, a.mokey, (count( a.id ) = count( b.filepath )) AS 'forcepointfinish' FROM inspectionpointdo a LEFT JOIN inspectionfiles b ON a.id = b.inspectionpointdoid WHERE a.inspectiondoid = ".concat(t," AND a.checktype = 999;");console.log(o),i.default.selectSql(o,(function(t){n&&n(t)}),(function(t){console.log(t),cbe&&cbe(t)}))}},d9fd:function(t,n,o){"use strict";o("7a82"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0,o("d81d"),o("d3b7"),o("3ca3"),o("ddb0"),o("e9c4");var e=function(){return plus.sqlite.isOpenDatabase({name:"EAMDB",path:"_doc/EAMDB.db"})},i={openDB:function(t,n,o){e()?n&&n():plus.sqlite.openDatabase({name:"EAMDB",path:"_doc/EAMDB.db",success:function(e){var i=t.map((function(t,n){return new Promise((function(n,o){t(n,o)}))}));Promise.all(i).then((function(t){n&&n(t)})).catch((function(t){o&&o(t),uni.showModal({title:"提示",content:"数据表创建失败"})}))},fail:function(t){o&&o(t),uni.showModal({title:"提示",content:"数据库打开失败"}),console.log("openDatabase failed: "+JSON.stringify(t))}})},openEamDataBase:function(){plus.sqlite.openDatabase({name:"EAMDB",path:"_doc/EAMDB.db",success:function(t){console.log("openDatabaseSuccess!")},fail:function(t){console.log("openDatabase failed: "+JSON.stringify(t))}})},closeDB:function(t){e()?plus.sqlite.closeDatabase({name:"EAMDB",success:function(n){console.log("closeDatabase success!"),t&&t()},fail:function(t){console.log("closeDatabase failed: "+JSON.stringify(t))}}):t&&t()},executeSql:function(t,n,o){e()?plus.sqlite.executeSql({name:"EAMDB",sql:t,success:function(t){console.log("executeSql success!"),n&&n()},fail:function(t){console.log("executeSql failed: "+JSON.stringify(t)),o&&o(t)}}):(this.openEamDataBase(),this.executeSql(t,n,o))},selectSql:function(t,n,o){var i=e();console.log(JSON.stringify(i)),i?plus.sqlite.selectSql({name:"EAMDB",sql:t,success:function(t){console.log("selectSql success! "),n&&n(t)},fail:function(t){console.log("selectSql failed: "+JSON.stringify(t)),o&&o(t)}}):(this.openEamDataBase(),this.selectSql(t,n,o))},drop:function(t,n,o){if(e()){var i="DROP TABLE IF EXISTS ".concat(t,";");plus.sqlite.executeSql({name:"EAMDB",sql:i,success:function(t){console.log("drop success!删表成功"),n&&n()},fail:function(t){console.log("executeSql failed: "+JSON.stringify(t)),o&&o(t)}})}else this.openEamDataBase(),this.drop(t,n,o)}},c=i;n.default=c}}]);