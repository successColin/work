(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-templates-webViewTemplate"],{5183:function(e,t,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("99af"),n("a9e3"),n("ac1f");var r=a(n("5530")),o=n("26cb"),i=a(n("6e6d")),c=n("acaa"),s={data:function(){return{webViewURL:"",isShow:!1,marginTop:0,barTitle:"",webviewStyles:{top:"44px",progress:{color:"#FF3333"}}}},directives:{webviewTop:{update:function(e,t,n){console.log("update:"+t.value);var a=t.value,r=t.oldValue;a!==r&&(e.style.top=t.value+"px")}}},computed:(0,r.default)((0,r.default)({},(0,o.mapState)(["bundleName","bundleId","BusinessID","account"])),(0,o.mapState)("common",["templateParams","tabsElements","tabsFormDatas"])),methods:(0,r.default)((0,r.default)((0,r.default)({},(0,o.mapMutations)("Toast",["TOAST_REQUESTURLS"])),(0,o.mapMutations)("common",["SET_TABS_ELEMENT","SET_TABS_FORMDATAS"])),{},{getUid:function(e,t){var n=this,a=t.static_uid;(0,c.APP_GetStandardUid)(this.account,a,this).then((function(a){delete t.static_uid,t.uid=a,t=(0,i.default)(t),n.webViewURL="".concat(e,"?").concat(t)}))},setPageInfo:function(e){var t=this,n=e.mobileTabsBYRelation,a=e.relationMainTab,r=e.mobileTabId,o=n.jumpUrl,c=n.elements;this.barTitle=n.mobileTabName||e.bundleName;var s={eventType:4,triggerList:[],relationMainTab:a,mobileTabId:r,formData:{},oldFormData:{},currentElements:c,currentBottomBtns:[],currentTopRightBtns:[],currentComboBoxs:[],triggerElements:c,oldElements:c,searchSelectInfo:{},loadsearchSelects:[],rules:[]};this.SET_TABS_ELEMENT({tabId:e.mobileTabId,elements:c}),this.Static_GlobalFucs.formElementsTrigger(s,this).then((function(e){var n=e.formData,a={};for(var r in n){var c=n[r],s=c.parameter,u=c.id;s&&(a[s]=u)}"static_uid"in a?t.getUid(o,a):(a=(0,i.default)(a),t.webViewURL="".concat(o,"?").concat(a))}))}}),onLoad:function(e){if(e.isPreview)return this.webViewURL=e.url,void(this.barTitle=e.fileName);this.TOAST_REQUESTURLS({type:"clear"});var t=e.relationTab;if(t){var n=this.templateParams[t]||{},a=uni.getStorageSync(n.bundleId)||{},r=a.mobileTabs||{},o=r[t]||{},i="webView".concat(this._uid),c=n.bundleId,s=n.bundleName,u=n.relationMainTab,l=n.onkey,d=n.refreshParams,f=a.triggerMap,p={_uid:this._uid,bundleId:c,bundleName:s,mobileTabId:Number(t),relationMainTab:u||"",mobileTabs:r,trigger:f||{},parentKey:l||"",selfKey:i,refreshParams:d||{},cascadeSelects:o.cascadeSelects||[],commonSelects:o.commonSelects||[],selectsFilterParams:o.filterParams||{},mobileTabsBYRelation:o};this.setPageInfo(p)}},mounted:function(){var e=this,t=uni.createSelectorQuery().in(this);uni.getSystemInfo({success:function(n){n.windowHeight;var a=n.statusBarHeight;t.select("#webViewBackBar").boundingClientRect((function(t){var n=t.height,r=a+n;e.marginTop=r})).exec()}})}};t.default=s},"61af":function(e,t,n){"use strict";n.r(t);var a=n("5183"),r=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=r.a},"6e6d":function(e,t,n){var a=n("7037").default;n("14d9");var r=Object.prototype.hasOwnProperty;e.exports=function e(t,n){var o=[];for(var i in t)if(r.call(t,i)){var c,s=t[i],u=encodeURIComponent(i);c="object"===a(s)?e(s,n?n+"["+u+"]":u):(n?n+"["+u+"]":u)+"="+encodeURIComponent(s),o.push(c)}return o.join("&")}},acaa:function(e,t,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.APP_singleLogin=t.APP_ZwdingtalkLogin=t.APP_StandardSingleLoginIT=t.APP_StandardSingleLogin=t.APP_GetStandardUid=t.APP_EnterpriseWechatLogin=void 0,t.getQueryString=d;var r=a(n("c7eb")),o=a(n("1da1"));n("4d63"),n("c607"),n("ac1f"),n("2c3e"),n("25f0"),n("466d"),n("841c"),n("d3b7"),n("c975"),n("99af"),n("e9c4");var i=n("af61");t.APP_singleLogin=function(e,t){var n=new RegExp("(^|&)code=([^&]*)(&|$)","i"),a=window.location.search.substr(1).match(n);return a?(e.type=1,e.threesidetoken=a[2],t.$http.post("sso/auth",e).then((function(e){var t=e.data||{};if(t.success)return t&&t.data;reject({type:"noTurnUp",msg:t.msg||"操作错误"})}))):new Promise((function(e,t){t("请重新登录")}))};var c=function(){var e=(0,o.default)((0,r.default)().mark((function e(t,n){var a,o,i,c,s,u,l,d,f;return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=document.cookie||"","LtpaToken=",{},o=a.indexOf("LtpaToken="),i="",a.length>0&&-1!==o&&(o+="LtpaToken=".length,c=a.indexOf(";",o),-1===c&&(c=a.length),i=a.substring(o,c)),i){e.next=7;break}return e.abrupt("return",new Promise((function(e,t){t("没有有效cookie,请重新登录.cookie:".concat(a,";Ltpatoken:").concat(i))})));case 7:return s={itToken:i,hasCompanyInfo:!0,hasAuthInfo:!0},u="",l="",e.next=11,n.$http.post("itSso/getAccount",s,{errorNoRefresh:!0,noToken:!0,iSNonstandard:!0}).then((function(e){var t=e.data||{};if(console.log(JSON.stringify(t)),console.log(JSON.stringify(e)),t.isError)l="上海电气接口提示:".concat(t.message||"",",cookie:").concat(a,";Ltpatoken:").concat(i);else{var n=t.account;u=n.code}})).catch((function(e){l="上海电气接口错误:".concat(e,",cookie:").concat(a,";Ltpatoken:").concat(i)}));case 11:if(d="",!u){e.next=17;break}return f=n.$EncryptionPSW({userCode:u},1),t.account=f.userCode,e.next=17,n.$http.post("sso/ssoByAccount",t,{errorNoRefresh:!0,noToken:!0}).then((function(e){var t=e.data||{};d=t.data})).catch((function(e){l=e||"ams接口错误,用户:".concat(u,";")}));case 17:if(d){e.next=21;break}return e.abrupt("return",new Promise((function(e,t){return t("".concat(l))})));case 21:return e.abrupt("return",d);case 22:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.APP_StandardSingleLoginIT=c;t.APP_StandardSingleLogin=function(e,t){var n=window.location.href,a={};if(-1!=n.indexOf("?"))for(var r=n.split("?")[1],o=r.split("&"),i=0,c=o.length;i<c;i++)a[o[i].split("=")[0]]=o[i].split("=")[1];return a.uid?(e.accessToken=a.uid,t.$http.post("ssoCommon/getUserInfoByToken",e).then((function(e){var t=e.data||{};if(t.success)return t&&t.data;reject({msg:"uid:".concat(a.uid,"，").concat(t.msg||"登录失败,请查询")})})).catch((function(e){uni.showModal({title:t.$t("basic-modalTipError"),content:"uid:".concat(a.uid,"，").concat(e||"登录失败,请查询"),showCancel:!1,confirmText:t.$t("basic-confirm")})}))):new Promise((function(e,t){t("没有uid,请重新登录")}))};var s=function(){var e=(0,o.default)((0,r.default)().mark((function e(t,n,a){var o,i,c,s,u,l,d,f;return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=(new Date).getTime(),i=a.$EncryptionPSW({timeStamp:o},1,"MD5"),c=i.timeStamp,s={timeStamp:o,checkSum:c},u="",e.next=6,a.$http.post("ssoCommon/getLoginKey",s,{errorNoRefresh:!0,noToken:!0,submitUrl:n}).then((function(e){var t=e.data||{};t.success&&(u=t.data)})).catch((function(e){uni.showModal({title:a.$t("basic-modalTipError"),content:e,showCancel:!1,confirmText:a.$t("basic-confirm")})}));case 6:return l="",d=a.$EncryptionPSW({value:"".concat(o).concat(u).concat(t)},1,"MD5"),f={loginKey:u,account:t,timeStamp:o,checkSum:d.value},e.next=9,a.$http.post("ssoCommon/ssoAuth",f,{errorNoRefresh:!0,noToken:!0,submitUrl:n}).then((function(e){var t=e.data||{};t.success&&(l=t.data)})).catch((function(e){uni.showModal({title:a.$t("basic-modalTipError"),content:e,showCancel:!1,confirmText:a.$t("basic-confirm")})}));case 9:return e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();t.APP_GetStandardUid=s;var u=function(){var e=(0,o.default)((0,r.default)().mark((function e(t,n){var a;return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={},e.next=3,(0,i.getDingDingCode)().then(function(){var e=(0,o.default)((0,r.default)().mark((function e(o){return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(o){e.next=4;break}return e.abrupt("return",new Promise((function(e,t){uni.showModal({title:"错误提示",content:"没有获取到code，请登录！",showCancel:!1,confirmText:"确定",success:function(e){e.confirm&&uni.reLaunch({url:"/pages/login/login"})}})})));case 4:return t.code=o,e.prev=5,e.next=8,n.$http.post("sso/zwdingtalkLogin",t).then((function(e){var t=e.data||{},n=t.success,r=t.data;if(!n)return new Promise((function(e,t){t(o)}));a=r}));case 8:e.next=13;break;case 10:return e.prev=10,e.t0=e["catch"](5),e.abrupt("return",new Promise((function(e,t){t(o)})));case 13:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(t){return e.apply(this,arguments)}}());case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();t.APP_ZwdingtalkLogin=u;var l=function(){var e=(0,o.default)((0,r.default)().mark((function e(t,n){var a,o;return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a={},o=d("code"),!o){e.next=12;break}return t.code=o,e.prev=4,e.next=7,n.$http.post("sso/wechatSSOLogin",t).then((function(e){var t=e.data||{},n=(t.success,t.data);a=n}));case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e["catch"](4),e.abrupt("return",new Promise((function(t,n){uni.showModal({title:"错误提示",content:e.t0,showCancel:!1,confirmText:"确定",success:function(e){e.confirm&&uni.reLaunch({url:"/pages/login/login"})}})})));case 12:return e.abrupt("return",a);case 13:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t,n){return e.apply(this,arguments)}}();function d(e,t){var n,a=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)"),"i");return n=t?t.split("?")[1].match(a):window.location.search.substr(1).match(a),null!=n?unescape(n[2]):null}t.APP_EnterpriseWechatLogin=l},ceea:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",[t("m-back-bar",{attrs:{id:"webViewBackBar"}},[t("template",{attrs:{slot:"barTitle"},slot:"barTitle"},[this._v(this._s(this.barTitle))])],2),t("v-uni-web-view",{directives:[{name:"webviewTop",rawName:"v-webviewTop",value:this.marginTop,expression:"marginTop"}],attrs:{src:this.webViewURL,"webview-styles":this.webviewStyles}})],1)},r=[]},e8b8:function(e,t,n){"use strict";n.r(t);var a=n("ceea"),r=n("61af");for(var o in r)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n("f0c5"),c=Object(i["a"])(r["default"],a["b"],a["c"],!1,null,"6e8daab5",null,!1,a["a"],void 0);t["default"]=c.exports}}]);