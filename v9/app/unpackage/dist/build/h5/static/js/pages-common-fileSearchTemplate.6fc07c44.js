(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-fileSearchTemplate"],{"0fa6":function(e,t,i){e.exports=i.p+"static/img/nodata.2945b091.png"},"4ef7":function(e,t,i){"use strict";i("7a82");var n=i("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("99af"),i("e9c4"),i("14d9"),i("fb6a"),i("e25e");var o=n(i("2909")),a=n(i("5530")),s=(n(i("3184")),i("26cb")),c=n(i("0fa6")),r={data:function(){return{placeholder:this.$t("formTip-placeholder"),searchText:"",onKey:"",searchHistory:[],hotSearch:[this.$t("lang-searchTemplate-fault-repair-order"),this.$t("lang-searchTemplate-plan-repair-order"),this.$t("lang-searchTemplate-inspection"),this.$t("page-knowledge")],iconSize:32,iconSizeFolder:66,iconSizeFile:74,id:"",userInfo:{userName:"",id:"12"},fileData:[],fileAllData:[],getFileData:[],cloudFileData:[],getCloudFileData:[],tabIndex:1,tabList:[{name:this.$t("page-internalDocument"),value:1},{name:this.$t("page-expertLibrary"),value:2,icon:"iconzhuanjiawenku",iconSize:24}],filePath:[{name:"全部",id:1}],tempFilePath:"",downFileName:"",downFileProsess:"",isLoading:!1,percent:1,nodataImg:c.default,fileLength:0,keywords:"",groupId:1,downloadUrl:"",isPreviewVideo:"",isPreviewSound:"",innerAudioContext:"",videoUrl:"",currentTime:0,surplusTime:0,duration:0,durationWidth:"",allFiles:[],pages:0,currentPage:1,size:20}},computed:(0,a.default)((0,a.default)({},(0,s.mapState)(["baseUrl","defaultUrl","token","themeColor"])),{},{themeClass_:function(){return"red"!==this.themeColor?"mainColor-"+this.themeColor:"mainColor"}}),methods:{handleSearch:function(){this.getFileData=[],this.currentPage=1,this.filePath=[{name:"全部",id:1}],this.searchFiles()},searchFiles:function(){var e=this;console.log(this.currentPage),e.$http.post("file/searchFiles",{pageNum:e.currentPage,pageSize:e.size,name:e.searchText}).then((function(t){e.getFileData=[].concat((0,o.default)(e.getFileData),(0,o.default)(t.data.data.list)),e.pages=t.data.data.pages})).catch((function(e){console.log(JSON.stringify(e))}))},handleClickHistory:function(e){this.searchText=e},clearHistory:function(){this.searchHistory=[],uni.removeStorageSync("searchHistory")},getFiles:function(e,t,i){var n=this;n.groupId=t||1,n.searchText&&(n.searchText=""),n.$http.post("file/getFiles",{groupId:t||1}).then((function(a){n.getFileData=[].concat((0,o.default)(a.data.data.filegroupList),(0,o.default)(a.data.data.fileList)),t&&!i?n.filePath.push(e):i||(n.filePath=[{name:"全部",id:1}]),uni.setStorageSync("filePath",n.filePath)})).catch((function(e){console.log(JSON.stringify(e))}))},goToStep:function(e,t){if(void 0!=t&&"undefined"!=t){var i;i=this.filePath.slice(0,t+1),uni.setStorageSync("filePath",this.filePath),this.filePath=i,e&&1!=e.id?this.getFiles(e,e.id,i):this.getFiles()}},downloadFile:function(e,t,i){var n=this,o="_downloads/"+t;this.fileLength=i,plus.io.resolveLocalFileSystemURL(o,(function(e){e.isFile&&uni.showModal({title:n.$t("basic-modalTip"),content:n.$t("choiceTip-whetherOpen")+t+n.$t("page-attachmentView"),confirmText:n.$t("basic-confirm"),cancelText:n.$t("basic-cancel"),success:function(t){t.confirm&&plus.runtime.openFile(o,{},(function(t){plus.nativeUI.alert(n.$t("pageTip-unableOpenFile")+"：entry"+e.toLocalURL()+"symurl"+o)}))}})}),(function(){n.dowload(e,t,i)}))},dowload:function(e,t,i){var n=this,o={method:"GET",filename:"_downloads/"+t},a=this.baseUrl||this.defaultUrl,s=a+"file/fileDownload?id="+e+"&token="+this.token,c=plus.downloader.createDownload(s,o,(function(e,t){200==t||(n.isLoading=!1)}));n.percent=0,c.start(),c.addEventListener("statechanged",(function(e,o){if(401!==o)switch(n.isLoading=!0,e.state){case 1:console.log("开始下载...");break;case 2:console.log("链接到服务器...");break;case 3:console.log("已接受到数据");var a=Math.floor(e.downloadedSize/i/10.24)||0;n.percent=a,console.log(n.percent);break;case 4:console.log("下载完成！"),console.log(JSON.stringify(e)),n.isLoading=!1,uni.showModal({title:n.$t("basic-modalTip"),content:n.$t("choiceTip-whetherOpen")+t+n.$t("page-attachmentView")+"?",confirmText:n.$t("basic-confirm"),cancelText:n.$t("basic-cancel"),success:function(t){t.confirm&&plus.runtime.openFile(e.filename,{},(function(e){plus.nativeUI.alert(n.$t("pageTip-unableOpenFile")+"："+e.message)}))}});break}else n.isLoading=!1}),!1)},cancleDownload:function(){this.isLoading=!1,console.log(this.isLoading),plus.downloader.clear()},formatDate:function(e){var t=new Date(e),i=t.getFullYear(),n=t.getMonth()+1;n=n<10?"0"+n:n;var o=t.getDate();o=o<10?"0"+o:o;var a=t.getHours();a=a<10?"0"+a:a;var s=t.getMinutes();s=s<10?"0"+s:s;var c=t.getSeconds();return c=c<10?"0"+c:c,i+"-"+n+"-"+o+" "+a+":"+s+":"+c},formatSize:function(e){return e>1024?parseInt(e/10.24)/100+"M":e+"K"},formatIcon:function(e){var t=e.split(".");return e=t[t.length-1],e},previewFile:function(e,t,i){var n=this.formatIcon(t);"jpg"==n||"jpeg"==n||"png"==n?this.previewImage(i):"mp3"==n?this.previewSound(i):"mp4"==n?this.previerVideo(i):"pdf"==n?this.previerPdf(e,t,i):this.downloadFile(e,t,i)},previewImage:function(e){uni.previewImage({urls:[e],longPressActions:{success:function(e){},fail:function(e){console.log(e.errMsg)}}})},previewSound:function(e){var t=this;this.innerAudioContext.src,this.innerAudioContext=uni.createInnerAudioContext(),this.innerAudioContext.src=e,this.innerAudioContext.onPlay((function(){t.duration=t.innerAudioContext.duration})),this.innerAudioContext.autoplay=!0,this.isPreviewSound=!0,this.innerAudioContext.onTimeUpdate((function(e){t.currentTime=t.innerAudioContext.currentTime,t.surplusTime=t.duration-t.currentTime,t.durationWidth=parseInt(1e4*t.currentTime/t.duration)/100+"%"}))},stopPreviewSound:function(){this.innerAudioContext.destroy(),this.isPreviewSound=!1,this.durationWidth=0,this.currentTime=0,this.surplusTime=0},previerVideo:function(e){this.videoContext=uni.createVideoContext("previerVideo"),this.isPreviewVideo=!0,this.videoUrl=e},shopPreviewVideo:function(){this.isPreviewVideo=!1},previerPdf:function(e,t,i){i="/pages/common/preview?url="+i,setTimeout((function(){uni.navigateTo({url:i})}),100)},formatTime:function(e,t){e=parseInt(e);var i=e>60?parseInt(e/60):0,n=e%60>=10?e%60:"0"+e%60;return 1==t?i+":"+n:"-"+i+":"+n},scrolltolower:function(){console.log(this.pages),this.pages>this.currentPage&&(this.currentPage+=1,console.log(this.currentPage),this.searchFiles())}},onLoad:function(e){this.searchHistory=uni.getStorageSync("searchHistory")||[],this.downloadUrl=this.baseUrl||this.defaultUrl,this.handleSearch()},onBackPress:function(){var e=this.filePath;if(e.length>1){var t=e[e.length-2];return this.goToStep(t,e.length-2),!0}}};t.default=r},6405:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"searchTemplate fileList"},[n("m-back-bar",[n("template",{attrs:{slot:"barTitle"},slot:"barTitle"},[e._v(e._s(e.$t("page-searchTitle")))])],2),n("v-uni-view",{staticClass:"search"},[n("v-uni-input",{attrs:{type:"text",focus:!0,placeholder:e.placeholder,"confirm-type":"search"},on:{confirm:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSearch()}},model:{value:e.searchText,callback:function(t){e.searchText=t},expression:"searchText"}}),n("m-button",{key:"searchBtn",staticClass:"search-btn",attrs:{isFontBtn:!0,btnClass:e.searchText?"mainColor":"searchColor"},on:{elementClick:function(t){arguments[0]=t=e.$handleEvent(t),e.handleSearch()}}},[n("template",{staticStyle:{display:"inline-block"},attrs:{slot:"buttonIcon"},slot:"buttonIcon"},[n("m-font-icon",{attrs:{icon:"iconsousuo",iconSize:34}})],1)],2)],1),n("v-uni-view",{staticClass:"filepath",class:[e.themeClass_]},[n("v-uni-view",{staticClass:"path-wrap"},e._l(e.filePath,(function(t,i){return n("v-uni-view",{key:"filePath"+i,staticClass:"path",on:{click:function(n){arguments[0]=n=e.$handleEvent(n),e.goToStep(t,i)}}},[0==i?n("m-font-icon",{attrs:{icon:"iconzhishikuweizhihuidaodiyiji",iconSize:e.iconSize}}):e._e(),e._v(e._s(t.name)),i<e.filePath.length-1?n("span",[e._v(">")]):e._e()],1)})),1)],1),n("v-uni-scroll-view",{staticClass:"list-wrap",attrs:{"scroll-y":!0},on:{scrolltolower:function(t){arguments[0]=t=e.$handleEvent(t),e.scrolltolower.apply(void 0,arguments)}}},e._l(e.getFileData,(function(t,o){return n("v-uni-view",{key:"uploadH5"+o},[1==t.basetype?n("v-uni-view",{staticClass:"fileItem",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.getFiles(t,t.id)}}},[n("v-uni-view",{staticClass:"icon-box"},[n("v-uni-image",{attrs:{src:i("9373")}})],1),n("v-uni-view",{staticClass:"folder"},[n("p",{staticClass:"title"},[e._v(e._s(t.name))]),n("p",{staticClass:"date"},[e._v(e._s(e.formatDate(t.createDate)))])]),n("v-uni-view",{staticClass:"arrow-right"},[n("span")])],1):n("v-uni-view",{staticClass:"fileItem"},[n("v-uni-view",{staticClass:"icon-box fileicon",on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.previewFile(t.id,t.displayFileName,t.url)}}},["png"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#4E94D9",icon:"APP_40",iconSize:64}}):"jpg"==e.formatIcon(t.displayFileName)||"jpeg"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#FF8102",icon:"APP_39",iconSize:64}}):"doc"==e.formatIcon(t.displayFileName)||"docx"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#FF933D",icon:"APP_37",iconSize:64}}):"ppt"==e.formatIcon(t.displayFileName)||"pptx"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#47C69A",icon:"APP_34",iconSize:64}}):"zip"==e.formatIcon(t.displayFileName)||"rar"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#B9C1CF",icon:"APP_36",iconSize:64}}):"pdf"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#F15643",icon:"APP_35",iconSize:64}}):"txt"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#F15643",icon:"APP_41",iconSize:64}}):"mp3"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#FF932F",icon:"APP_42",iconSize:64}}):"mp4"==e.formatIcon(t.displayFileName)?n("m-font-icon",{attrs:{color:"#4E7DD9",icon:"APP_43",iconSize:64}}):n("m-font-icon",{attrs:{color:"#B9C1CF",icon:"APP_38",iconSize:64}})],1),n("v-uni-view",{staticClass:"file",staticStyle:{width:"85%"},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.previewFile(t.id,t.displayFileName,t.url)}}},[n("p",{staticClass:"title"},[e._v(e._s(t.displayFileName))]),n("p",{staticClass:"date"},[e._v(e._s(e.formatDate(t.updateDate))),n("v-uni-view",{staticClass:"fileSize"},[e._v(e._s(e.formatSize(t.fileLength)))])],1)])],1)],1)})),1),e.isLoading?n("v-uni-view",{staticClass:"downloadPro"},[n("v-uni-view",{staticClass:"downloadBox"},[n("p",{staticClass:"downname i18n"},[n("span",[e._v(e._s(e.downFileName))]),e._v(e._s(e.$t("pageTip-downloading"))+"...")]),n("v-uni-view",{staticClass:"progress-box progressBox"},[n("v-uni-view",{staticClass:"progressState",style:{width:e.percent+"%"}})],1),n("p",{staticClass:"downpro"},[e._v(e._s(e.percent)+"%")])],1),n("v-uni-button",{staticClass:"abort-download",attrs:{type:"default"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancleDownload.apply(void 0,arguments)}}},[e._v(e._s(e.$t("page-cancelDownload")))])],1):e._e(),e.isPreviewVideo?n("v-uni-view",{staticClass:"previewVideoBox"},[n("v-uni-video",{attrs:{id:"previewVideo",src:e.videoUrl,controls:!0}}),n("m-font-icon",{staticClass:"closeVideo",attrs:{icon:"iconqingchu",iconSize:32},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.shopPreviewVideo.apply(void 0,arguments)}}})],1):e._e(),e.isPreviewSound?n("v-uni-view",{staticClass:"previewSoundBox"},[n("v-uni-view",{staticClass:"soundPanel"},[n("v-uni-view",{staticClass:"currentTime"},[e._v(e._s(e.formatTime(e.currentTime,2)))]),n("v-uni-view",{staticClass:"progressBar"},[n("v-uni-view",{style:{width:e.durationWidth}})],1),n("v-uni-view",{staticClass:"surplusTime"},[e._v(e._s(e.formatTime(e.surplusTime,1)))])],1),n("m-font-icon",{staticClass:"closeSound",attrs:{icon:"iconqingchu",iconSize:32},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.stopPreviewSound.apply(void 0,arguments)}}})],1):e._e()],1)},o=[]},"6c88":function(e,t,i){"use strict";i.r(t);var n=i("4ef7"),o=i.n(n);for(var a in n)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a},9373:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFIAAABSCAYAAADHLIObAAAAAXNSR0IArs4c6QAAA3xJREFUeAHt3EtrE1EUB/BzJknTR2qr+OhCBF24qA+0tRvBhS987ZT6NSroRty0CxfuXbnwA9iVi5baFqRYBKErofUBgiu11oWCIrYm15NI4N5pTjMHkrRl/gNpZub8Z+69v9zJZNGECAsEIAABCEAAAhCAAAQgAAEIQAACjRRg7WTOUURTdIMc3ZTHADH1yHNGy5v2My1L/hpfpQ+m47ZwuCakm6VDtErjFcBmdZ7pk7ws5/kSvW1WE6087zpI94wOUpFeCeKepneE6avM9It8hV43va0mNxD555fLmQXxSUsQyw072iuP526CTvn92I7rASRN0nUZWGsH5WiXvHyzciWc3o6A1T6HkEzD1UJLn53cyIo07abobEvbbWBjIaSj4w08t+1UjroEc0IwL9sO3Brp4GbjJuXN37/JZHJEbQWibDtR1JhPPgmGXZK2lqUfW2FZpVLxG1Fxhgr5B3zy43etUyHkBK1IcDexTNQuuWl37NSOS9/+0t81Wvt5n898Gas1+PDSriRkV88BIMa1omyO8r2jbn7/O+dG17mt20HdfUQ5uZSx1BZoKxym+UfT8WIImevMUvuOeAbbcYF89zk3t++YvzuE7OjJ+0WsawLMlOF7fjWEzHTIbRpLIgGXPernQsgoE277SayHAlHU5e8I4cItP4f1OgKgqwOUtAzIpFJ1coCsA5S0DMikUnVygKwDlLQcQjouJj0QOf7lG4SQUfTDL2J9A4Fc54JfDSH9CtZNAoA0celhQOo2pgogTVx6GJC6jakCSBOXHgakbmOqANLEpYcBqduYKoA0celhQOo2pgogTVx6GJC6jakCSBOXHgakbmOqANLEpYcBqduYKoA0celhQOo2pgogTVx6GJC6jakCSBOXHgakbmOqANLEpYcBqduYKoA0celhQOo2pkocctV0dLrDgVUc8nO6bQyjjziwikFGc4ZTpTvKHFiFkDl6LF9CL6VbKMno+T0N9OuQfGJpUb7e+zDJqVKbKU+0TDTCPB78U244I8s6Q323iflpaqE2Gvj/q3WEBxen4jGO7yhvO+eYFvrvyOpd2cCXtitIvCRve7d46M1MZTP2pyZkNeMWjxTod+mCTGb5ASXXKzO1ZT8jUO3Dpj47+iMTaUV+0eAFDQ6/ZB7F/WNTXxA0DgEIQAACEIAABCAAAQhAAAJpEvgH6eWJz/jH/AQAAAAASUVORK5CYII="},cfee:function(e,t,i){"use strict";i.r(t);var n=i("6405"),o=i("6c88");for(var a in o)["default"].indexOf(a)<0&&function(e){i.d(t,e,(function(){return o[e]}))}(a);var s=i("f0c5"),c=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"08c6ef6c",null,!1,n["a"],void 0);t["default"]=c.exports}}]);